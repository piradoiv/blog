// Generated by CoffeeScript 1.6.2
(function() {
  var lookForCodemirror, updatePreview, useEditorOn;

  useEditorOn = function(id) {
    return CodeMirror.fromTextArea(id, {
      theme: 'monokai',
      lineNumbers: true,
      mode: 'application/x-httpd-php'
    });
  };

  lookForCodemirror = function() {
    var cmCounter;

    cmCounter = 0;
    return $('.codemirror').each(function() {
      var identifier;

      $(this).attr('id', "codemirror-" + cmCounter);
      identifier = $(this)[0];
      useEditorOn(identifier);
      return cmCounter++;
    });
  };

  lookForCodemirror();

  updatePreview = function() {
    return $.post(previewUrl, $('form').serialize(), function(data) {
      $('.article-preview').html(data);
      return lookForCodemirror();
    });
  };

  if (typeof articleId !== "undefined" && articleId !== null) {
    useEditorOn($('.article-contents')[0]);
    updatePreview();
    $('input, textarea').on('keyup', function() {
      return updatePreview();
    });
  }

}).call(this);
